<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>spo2-calculation.js</title><link rel="stylesheet" type="text/css" href="../../styles/main.css" /><script type="text/javascript" src="../../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.0.2 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="Functions"></a><a name="Topic23"></a><div class="CTopic TGroup LJavaScript first">
 <div class="CTitle">Functions</div>
</div>

<a name="SPO2Calculation"></a><a name="Topic166"></a><div class="CTopic TFunction LJavaScript">
 <div class="CTitle">SPO2Calculation</div>
 <div id="NDPrototype166" class="NDPrototype NoParameterForm"><span class="SHKeyword">var</span> SPO2Calculation = <span class="SHKeyword">function</span>()</div>
 <div class="CBody"><p>Performs all necessary calculations for the SPO2.</p></div>
</div>

<a name="Variables"></a><a name="Topic11"></a><div class="CTopic TGroup LJavaScript">
 <div class="CTitle">Variables</div>
</div>

<a name="self"></a><a name="Topic12"></a><div class="CTopic TVariable LJavaScript">
 <div class="CTitle">self</div>
 <div id="NDPrototype12" class="NDPrototype NoParameterForm"><span class="SHKeyword">var</span> self</div>
 <div class="CBody"><p>Used to be able to adress the <a href="../../index.html#File:js/spo2-calculation.js:currentSpO2" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,169);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >currentSpO2</a> property from within other functions in <a href="../../index.html#File:js/spo2-calculation.js:SPO2Calculation" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,166);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >SPO2Calculation</a>.</p></div>
</div>

<a name="currentSpO2"></a><a name="Topic169"></a><div class="CTopic TVariable LJavaScript">
 <div class="CTitle">currentSpO2</div>
 <div id="NDPrototype169" class="NDPrototype NoParameterForm"><span class="SHKeyword">this</span>.currentSpO2</div>
 <div class="CBody"><p>Contains the current spo2-value.</p></div>
</div>

<a name="currentTime"></a><a name="Topic14"></a><div class="CTopic TVariable LJavaScript">
 <div class="CTitle">currentTime</div>
 <div id="NDPrototype14" class="NDPrototype NoParameterForm"><span class="SHKeyword">var</span> currentTime</div>
 <div class="CBody"><p>Contains the currentTime of the spo2-simulation.</p></div>
</div>

<a name="timeSinceSpO2Change"></a><a name="Topic15"></a><div class="CTopic TVariable LJavaScript">
 <div class="CTitle">timeSinceSpO2Change</div>
 <div id="NDPrototype15" class="NDPrototype NoParameterForm"><span class="SHKeyword">var</span> timeSinceSpO2Change</div>
 <div class="CBody"><p>Contains the time since last <a href="../../index.html#File:js/spo2-calculation.js:currentSpO2" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,169);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >currentSpO2</a> change to calculate the value dynamically.</p></div>
</div>

<a name="oldSpo2MaxValue"></a><a name="Topic16"></a><div class="CTopic TVariable LJavaScript">
 <div class="CTitle">oldSpo2MaxValue</div>
 <div id="NDPrototype16" class="NDPrototype NoParameterForm"><span class="SHKeyword">var</span> oldSpo2MaxValue</div>
 <div class="CBody"><p>Contains the old spo2-maximum, which is used in the dynamic changing process.</p></div>
</div>

<a name="timeSinceIntermediateSpO2Change"></a><a name="Topic181"></a><div class="CTopic TVariable LJavaScript">
 <div class="CTitle">timeSinceIntermediateSpO2Change</div>
 <div id="NDPrototype181" class="NDPrototype NoParameterForm"><span class="SHKeyword">var</span> timeSinceIntermediateSpO2Change</div>
 <div class="CBody"><p>Contains the time since the last intermediate spo2 change. Is used to perform changes to the <a href="../../index.html#File:js/spo2-calculation.js:currentSpO2" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,169);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >currentSpO2</a> only at the end of the current period.</p></div>
</div>

<a name="latestReachedSpO2"></a><a name="Topic182"></a><div class="CTopic TVariable LJavaScript">
 <div class="CTitle">latestReachedSpO2</div>
 <div id="NDPrototype182" class="NDPrototype NoParameterForm"><span class="SHKeyword">var</span> latestReachedSpO2</div>
 <div class="CBody"><p>Contains the old &quot;currentSpo2&quot; after a config change. It is used to react to changes to the <a href="../../index.html#File:js/spo2-calculation.js:currentSpO2" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,169);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >currentSpO2</a> while an old change is still in process.</p></div>
</div>

<a name="lastDeltaX"></a><a name="Topic19"></a><div class="CTopic TVariable LJavaScript">
 <div class="CTitle">lastDeltaX</div>
 <div id="NDPrototype19" class="NDPrototype NoParameterForm"><span class="SHKeyword">var</span> lastDeltaX</div>
 <div class="CBody"><p>When the ecgCalculation gets deactivated, the ecgCalculation.simTime is not counted up anymore. Therefore, the old simTime Value gets saved in each step to adress this problem.</p></div>
</div>

<a name="hfIdleCount"></a><a name="Topic20"></a><div class="CTopic TVariable LJavaScript">
 <div class="CTitle">hfIdleCount</div>
 <div id="NDPrototype20" class="NDPrototype NoParameterForm"><span class="SHKeyword">var</span> hfIdleCount</div>
 <div class="CBody"><p>Is used to count up the time without ecg. If the time is higher then <a href="../../index.html#File:js/spo2-calculation.js:maxHFIdleCount" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,22);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >maxHFIdleCount</a>, The spo2 curve is simulated on its own.</p></div>
</div>

<a name="Constants"></a><a name="Topic21"></a><div class="CTopic TGroup LJavaScript">
 <div class="CTitle">Constants</div>
</div>

<a name="maxHFIdleCount"></a><a name="Topic22"></a><div class="CTopic TConstant LJavaScript">
 <div class="CTitle">maxHFIdleCount</div>
 <div class="CBody"><p>Contains the max amount of steps that are tolerable for an ecg signal to be missing.&nbsp; 4 steps equal to 4*0.02 seconds</p></div>
</div>

<a name="Functions(2)"></a><a name="Topic183"></a><div class="CTopic TGroup LJavaScript">
 <div class="CTitle">Functions</div>
</div>

<a name="errorFunction"></a><a name="Topic24"></a><div class="CTopic TFunction LJavaScript">
 <div class="CTitle">errorFunction</div>
 <div id="NDPrototype24" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">function</span> errorFunction(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">x</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>This function is used to build up the shape of the spo2-curve. It is used twice in the process for the first and the second peak. Even if the function is called errorFunction, it is solemnly used to <b>simulate the correct shape</b> of the spo2-curve.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">x</td><td class="CDLDefinition"><p>Used to calcuate the &quot;error&quot; for.</p></td></tr></table><p>See also: This implementation is based on an article: <a href="https://www.johndcook.com/blog/2009/01/19/stand-alone-error-function-erf/" target="_top">Stand-alone error function errorFunction(x)</a> using the <a href="https://www.desmos.com/calculator/t1v4bdpske" target="_top">Mathematical Simulation</a> of the error-Function. Theory: <a href="https://en.wikipedia.org/wiki/Error_function#Approximation_with_elementary_functions" target="_top">Wikipedia</a></p></div>
</div>

<a name="getCurrentSpO2Value"></a><a name="Topic25"></a><div class="CTopic TFunction LJavaScript">
 <div class="CTitle">getCurrentSpO2Value</div>
 <div id="NDPrototype25" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">function</span> getCurrentSpO2Value(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">newSpO2,</td></tr><tr><td class="PName first last">period,</td></tr><tr><td class="PName first last">spo2ChangeDuration</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>This function is used to calculated the current spo2-value. It was needed to have and dynamic change for the maximal spo2-value after a change.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">newSpO2</td><td class="CDLDefinition"><p>Contains the new spo2-maximum value.</p></td></tr><tr><td class="CDLEntry">period</td><td class="CDLDefinition"><p>Contains the period of the spo2-curve. This value is based on the hr.</p></td></tr><tr><td class="CDLEntry">spo2ChangeDuration</td><td class="CDLDefinition"><p>Contains an object which contains an boolean, indicating if the duration for an adaption is automatically chosen and an value, if a manual duration is chosen.</p></td></tr></table><div class="CHeading">Returns</div><p>The calculated current spo2-max.</p><p>See also: This function uses an implementation of the <a href="https://en.wikipedia.org/wiki/Logistic_function" target="_top">Logistic Function</a> to perform the dynamic changes.</p></div>
</div>

<a name="calcFullSpo2"></a><a name="Topic26"></a><div class="CTopic TFunction LJavaScript">
 <div class="CTitle">calcFullSpo2</div>
 <div id="NDPrototype26" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">function</span> calcFullSpo2(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">firstY,</td></tr><tr><td class="PName first last">currentSpO2,</td></tr><tr><td class="PName first last">x0,</td></tr><tr><td class="PName first last">sigma,</td></tr><tr><td class="PName first last">M,</td></tr><tr><td class="PName first last">x</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>This function calculates the full spo2-curve-value for the given point in time.&nbsp; &quot;full&quot; in this case means, that it calculates the second &quot;spo2-curve-peak&quot; and adds it to the first.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">firstY</td><td class="CDLDefinition"><p>Contains the first calculated spo2-curve value.</p></td></tr><tr><td class="CDLEntry">currentSpO2</td><td class="CDLDefinition"><p>Contains the current spo2-max.</p></td></tr><tr><td class="CDLEntry">x0</td><td class="CDLDefinition"><p>Contains the x0-parameter from the first spo2-curve-peak.</p></td></tr><tr><td class="CDLEntry">sigma</td><td class="CDLDefinition"><p>Contains the sigma-parameter from the first spo2-curve-peak.</p></td></tr><tr><td class="CDLEntry">M</td><td class="CDLDefinition"><p>Contains the M-constant for normalization</p></td></tr><tr><td class="CDLEntry">x</td><td class="CDLDefinition"><p>Contains the value for which the spo2-curve is calculated.</p></td></tr></table><div class="CHeading">Returns</div><p>The calculated f(x).</p></div>
</div>

<a name="calc"></a><a name="Topic27"></a><div class="CTopic TFunction LJavaScript last">
 <div class="CTitle">calc</div>
 <div id="NDPrototype27" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">this</span>.calc = <span class="SHKeyword">function</span>(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first">hr,</td><td></td><td class="last"></td></tr><tr><td class="PName first">spo2MaxValue,</td><td></td><td class="last"></td></tr><tr><td class="PName first">spo2ChangeDuration,</td><td></td><td class="last"></td></tr><tr><td class="PName first">isPacerUsed&nbsp;</td><td class="PDefaultValueSeparator">=&nbsp;</td><td class="PDefaultValue last"><span class="SHKeyword">false</span></td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>This function is used to calculate the current f(x)</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">hr</td><td class="CDLDefinition"><p>Contains the current heart-rate.</p></td></tr><tr><td class="CDLEntry">spo2MaxValue</td><td class="CDLDefinition"><p>Contains the max spo2-value.</p></td></tr><tr><td class="CDLEntry">spo2ChangeDuration</td><td class="CDLDefinition"><p>Contains an object which contains an boolean, indicating if the duration for an adaption is automatically chosen and an value, if a manual duration is chosen.</p></td></tr></table></div>
</div>

</body></html>